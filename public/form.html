<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>디맨드 근무 후기 이벤트</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen py-8 px-4">
        <div class="max-w-2xl mx-auto">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <div class="text-center mb-8">
                    <h1 class="text-2xl font-bold text-gray-800 mb-4">근무 후기 이벤트 참여</h1>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progressBar" class="bg-blue-600 h-2 rounded-full transition-all duration-500" style="width: 33.33%"></div>
                    </div>
                    <p class="text-gray-600 mt-2"><span id="currentStep">1</span> / 3</p>
                </div>

                <form name="work-review" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" enctype="multipart/form-data">
                    <input type="hidden" name="form-name" value="work-review" />
                    <p class="hidden">
                        <label>Don't fill this out if you're human: <input name="bot-field" /></label>
                    </p>

                    <!-- Page 1 -->
                    <div id="page1" class="form-page">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">이름 *</label>
                                <input type="text" name="name" required class="w-full p-3 border rounded-lg">
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">이메일 *</label>
                                <input type="email" name="email" required placeholder="admin@domain.com" class="w-full p-3 border rounded-lg">
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">전화번호 *</label>
                                <input type="tel" name="phone" required placeholder="010-0000-0000" class="w-full p-3 border rounded-lg">
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">어떤 경로로 후기 이벤트를 접하게 되었나요? *</label>
                                <select name="source" required class="w-full p-3 border rounded-lg">
                                    <option value="">선택해주세요</option>
                                    <option value="디맨드 홈페이지">디맨드 홈페이지</option>
                                    <option value="디맨드 인스타그램">디맨드 인스타그램</option>
                                    <option value="디맨드 스레드">디맨드 스레드</option>
                                    <option value="디맨드 오픈채팅방">디맨드 오픈채팅방</option>
                                    <option value="인스타그램 광고">인스타그램 광고</option>
                                    <option value="디맨드 블로그">디맨드 블로그</option>
                                    <option value="기타">기타</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">최종학력 *</label>
                                <select name="education" required class="w-full p-3 border rounded-lg">
                                    <option value="">선택해주세요</option>
                                    <option value="고졸">고졸</option>
                                    <option value="초대졸">초대졸</option>
                                    <option value="대졸">대졸</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">회사명(근무지명) *</label>
                                <p class="text-xs text-gray-400 mb-2">가능한 줄임 없이 풀어서 써주세요 (하닉 → SK하이닉스)</p>
                                <input type="text" name="company" required class="w-full p-3 border rounded-lg">
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">사업장 주소 *</label>
                                <div class="flex gap-2 mb-2">
                                    <input type="text" name="postcode" placeholder="우편번호" readonly required class="flex-1 p-3 border rounded-lg">
                                    <button type="button" onclick="execDaumPostcode()" class="px-4 py-3 bg-gray-100 border rounded-lg">주소 찾기</button>
                                </div>
                                <input type="text" name="roadAddress" placeholder="도로명 주소" readonly required class="w-full p-3 border rounded-lg mb-2">
                                <input type="text" name="detailAddress" placeholder="상세주소 입력" required class="w-full p-3 border rounded-lg">
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">직무 대분류 *</label>
                                <select name="majorCategory" required class="w-full p-3 border rounded-lg" onchange="updateMinorCategories()">
                                    <option value="">대분류를 선택해주세요</option>
                                    <option value="10001">서비스업</option>
                                    <option value="10002">금융·은행업</option>
                                    <option value="10007">IT·정보통신업</option>
                                    <option value="10031">개발·데이터</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">직무 소분류 *</label>
                                <select name="minorCategory" required class="w-full p-3 border rounded-lg" id="minorCategory">
                                    <option value="">소분류를 선택해주세요</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2">근무 기간 *</label>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm mb-2">시작일</label>
                                        <div class="flex gap-2">
                                            <select name="workStartYear" required class="flex-1 p-3 border rounded-lg">
                                                <option value="">년도</option>
                                                <option value="2024">2024년</option>
                                                <option value="2023">2023년</option>
                                                <option value="2022">2022년</option>
                                                <option value="2021">2021년</option>
                                                <option value="2020">2020년</option>
                                            </select>
                                            <select name="workStartMonth" required class="flex-1 p-3 border rounded-lg">
                                                <option value="">월</option>
                                                <option value="1">1월</option>
                                                <option value="2">2월</option>
                                                <option value="3">3월</option>
                                                <option value="4">4월</option>
                                                <option value="5">5월</option>
                                                <option value="6">6월</option>
                                                <option value="7">7월</option>
                                                <option value="8">8월</option>
                                                <option value="9">9월</option>
                                                <option value="10">10월</option>
                                                <option value="11">11월</option>
                                                <option value="12">12월</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="flex items-center gap-2">
                                        <input type="checkbox" id="currentJob" name="isCurrentJob" checked onchange="toggleEndDate()">
                                        <label for="currentJob" class="text-sm">현재 재직중</label>
                                    </div>

                                    <div id="endDateSection" class="hidden">
                                        <label class="block text-sm mb-2">종료일</label>
                                        <div class="flex gap-2">
                                            <select name="workEndYear" class="flex-1 p-3 border rounded-lg">
                                                <option value="">년도</option>
                                                <option value="2024">2024년</option>
                                                <option value="2023">2023년</option>
                                                <option value="2022">2022년</option>
                                                <option value="2021">2021년</option>
                                                <option value="2020">2020년</option>
                                            </select>
                                            <select name="workEndMonth" class="flex-1 p-3 border rounded-lg">
                                                <option value="">월</option>
                                                <option value="1">1월</option>
                                                <option value="2">2월</option>
                                                <option value="3">3월</option>
                                                <option value="4">4월</option>
                                                <option value="5">5월</option>
                                                <option value="6">6월</option>
                                                <option value="7">7월</option>
                                                <option value="8">8월</option>
                                                <option value="9">9월</option>
                                                <option value="10">10월</option>
                                                <option value="11">11월</option>
                                                <option value="12">12월</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="flex items-center gap-2">
                                <input type="checkbox" id="privacy" name="privacyConsent" required>
                                <label for="privacy" class="text-sm">개인정보 수집 및 활용에 동의합니다. (개인정보는 수집만 하고 어디에 노출되지 않습니다) *</label>
                            </div>

                            <button type="button" onclick="nextPage()" class="w-full bg-blue-600 text-white py-3 rounded-lg font-medium">다음 (1/3)</button>
                        </div>
                    </div>

                    <!-- Page 2 -->
                    <div id="page2" class="form-page hidden">
                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold mb-2">현직자 인증</h3>
                            <p class="text-gray-600 mb-4">
                                증빙 자료를 첨부해주세요. 증빙이 인증되면 이벤트 보상 제공 대상에 자동으로 포함됩니다. 하지만, 증빙 자료가 첨부되지 않았더라도 근무했다는 사실이 리뷰를 통해 충분히 인정되면 이벤트 보상 제공 대상에 포함될 수 있습니다.
                            </p>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                                <input type="file" name="proofFile" accept="image/*,application/pdf" class="mx-auto">
                                <p class="text-sm text-gray-500 mt-2">
                                    예: 사원증, 사내 시스템 화면 등 / 이미지 또는 PDF 파일, 15일 이내 자동 삭제됩니다
                                </p>
                            </div>

                            <div class="flex gap-4">
                                <button type="button" onclick="prevPage()" class="flex-1 bg-gray-100 py-3 rounded-lg">이전</button>
                                <button type="button" onclick="nextPage()" class="flex-1 bg-blue-600 text-white py-3 rounded-lg">다음 (2/3)</button>
                            </div>
                        </div>
                    </div>

                    <!-- Page 3 -->
                    <div id="page3" class="form-page hidden">
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold">현직자 상세 리뷰</h3>

                            <!-- 근무환경/시설 -->
                            <div class="space-y-3 p-4 border rounded-lg">
                                <div>
                                    <h4 class="font-medium">1. 근무환경/시설</h4>
                                    <p class="text-sm text-gray-600">사무실 환경, 편의 시설, 장비/시설 등</p>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">평점 평가 *</label>
                                    <select name="근무환경시설-rating" required class="w-full p-2 border rounded-md">
                                        <option value="">선택해주세요</option>
                                        <option value="5">5 (매우 좋음)</option>
                                        <option value="4">4 (좋음)</option>
                                        <option value="3">3 (보통)</option>
                                        <option value="2">2 (나쁨)</option>
                                        <option value="1">1 (매우 나쁨)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">상세 리뷰 *</label>
                                    <p class="text-xs text-gray-500 mb-2">사무실이 쾌적하고 근무 환경이 좋은지, 휴게 공간이나 카페테리아 등의 편의시설이 잘 갖춰져 있는지, 업무에 필요한 장비나 시설이 충분한지 등을 평가해 주세요.</p>
                                    <textarea name="근무환경시설-detail" required rows="4" class="w-full p-2 border rounded-md resize-none" placeholder="최소 50자 이상 입력해주세요" oninput="updateCharCount(this, '근무환경시설')"></textarea>
                                    <p class="text-xs text-gray-500 mt-1"><span id="근무환경시설-count">0</span>/50자 이상</p>
                                </div>
                            </div>

                            <!-- 근무강도/스트레스 -->
                            <div class="space-y-3 p-4 border rounded-lg">
                                <div>
                                    <h4 class="font-medium">2. 근무강도/스트레스</h4>
                                    <p class="text-sm text-gray-600">업무량, 야근, 스트레스 정도 등</p>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">평점 평가 *</label>
                                    <select name="근무강도스트레스-rating" required class="w-full p-2 border rounded-md">
                                        <option value="">선택해주세요</option>
                                        <option value="5">5 (매우 좋음)</option>
                                        <option value="4">4 (좋음)</option>
                                        <option value="3">3 (보통)</option>
                                        <option value="2">2 (나쁨)</option>
                                        <option value="1">1 (매우 나쁨)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">상세 리뷰 *</label>
                                    <p class="text-xs text-gray-500 mb-2">업무량이 적절한지, 야근이나 주말 근무는 얼마나 자주 있는지, 업무로 인한 스트레스는 어느 정도인지 등을 평가해 주세요.</p>
                                    <textarea name="근무강도스트레스-detail" required rows="4" class="w-full p-2 border rounded-md resize-none" placeholder="최소 50자 이상 입력해주세요" oninput="updateCharCount(this, '근무강도스트레스')"></textarea>
                                    <p class="text-xs text-gray-500 mt-1"><span id="근무강도스트레스-count">0</span>/50자 이상</p>
                                </div>
                            </div>

                            <!-- 급여/복지 -->
                            <div class="space-y-3 p-4 border rounded-lg">
                                <div>
                                    <h4 class="font-medium">3. 급여/복지</h4>
                                    <p class="text-sm text-gray-600">급여, 복지, 휴가, 인센티브 등</p>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">평점 평가 *</label>
                                    <select name="급여복지-rating" required class="w-full p-2 border rounded-md">
                                        <option value="">선택해주세요</option>
                                        <option value="5">5 (매우 좋음)</option>
                                        <option value="4">4 (좋음)</option>
                                        <option value="3">3 (보통)</option>
                                        <option value="2">2 (나쁨)</option>
                                        <option value="1">1 (매우 나쁨)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">상세 리뷰 *</label>
                                    <p class="text-xs text-gray-500 mb-2">급여가 업계 평균 대비 어느 정도인지, 복지 혜택은 어떤지, 휴가 사용이 자유로운지 등을 평가해 주세요.</p>
                                    <textarea name="급여복지-detail" required rows="4" class="w-full p-2 border rounded-md resize-none" placeholder="최소 50자 이상 입력해주세요" oninput="updateCharCount(this, '급여복지')"></textarea>
                                    <p class="text-xs text-gray-500 mt-1"><span id="급여복지-count">0</span>/50자 이상</p>
                                </div>
                            </div>

                            <!-- 안정성/전망 -->
                            <div class="space-y-3 p-4 border rounded-lg">
                                <div>
                                    <h4 class="font-medium">4. 안정성/전망</h4>
                                    <p class="text-sm text-gray-600">회사 안정성, 성장 가능성, 전망 등</p>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">평점 평가 *</label>
                                    <select name="안정성전망-rating" required class="w-full p-2 border rounded-md">
                                        <option value="">선택해주세요</option>
                                        <option value="5">5 (매우 좋음)</option>
                                        <option value="4">4 (좋음)</option>
                                        <option value="3">3 (보통)</option>
                                        <option value="2">2 (나쁨)</option>
                                        <option value="1">1 (매우 나쁨)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">상세 리뷰 *</label>
                                    <p class="text-xs text-gray-500 mb-2">회사가 안정적으로 운영되고 있는지, 앞으로의 성장 가능성은 어떤지 등을 평가해 주세요.</p>
                                    <textarea name="안정성전망-detail" required rows="4" class="w-full p-2 border rounded-md resize-none" placeholder="최소 50자 이상 입력해주세요" oninput="updateCharCount(this, '안정성전망')"></textarea>
                                    <p class="text-xs text-gray-500 mt-1"><span id="안정성전망-count">0</span>/50자 이상</p>
                                </div>
                            </div>

                            <!-- 사람들 -->
                            <div class="space-y-3 p-4 border rounded-lg">
                                <div>
                                    <h4 class="font-medium">5. 사람들</h4>
                                    <p class="text-sm text-gray-600">동료, 상사, 회사 분위기 등</p>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">평점 평가 *</label>
                                    <select name="사람들-rating" required class="w-full p-2 border rounded-md">
                                        <option value="">선택해주세요</option>
                                        <option value="5">5 (매우 좋음)</option>
                                        <option value="4">4 (좋음)</option>
                                        <option value="3">3 (보통)</option>
                                        <option value="2">2 (나쁨)</option>
                                        <option value="1">1 (매우 나쁨)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">상세 리뷰 *</label>
                                    <p class="text-xs text-gray-500 mb-2">동료들과의 관계는 어떤지, 상사나 관리자들은 어떤지, 전반적인 회사 분위기나 문화는 어떤지 등을 평가해 주세요.</p>
                                    <textarea name="사람들-detail" required rows="4" class="w-full p-2 border rounded-md resize-none" placeholder="최소 50자 이상 입력해주세요" oninput="updateCharCount(this, '사람들')"></textarea>
                                    <p class="text-xs text-gray-500 mt-1"><span id="사람들-count">0</span>/50자 이상</p>
                                </div>
                            </div>

                            <!-- 취업준비 -->
                            <div class="space-y-3 p-4 border rounded-lg">
                                <div>
                                    <h4 class="font-medium">6. 취업준비</h4>
                                    <p class="text-sm text-gray-600">취업 준비, 스펙, 경쟁률 등</p>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">난이도 평가 *</label>
                                    <select name="취업준비-rating" required class="w-full p-2 border rounded-md">
                                        <option value="">선택해주세요</option>
                                        <option value="1">1 (쉬움)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4 (어려움)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">상세 리뷰 *</label>
                                    <p class="text-xs text-gray-500 mb-2">이 회사에 취업하기 위해 어떤 준비가 필요한지, 어느 정도의 스펙이나 경력이 요구되는지 등을 평가해 주세요.</p>
                                    <textarea name="취업준비-detail" required rows="4" class="w-full p-2 border rounded-md resize-none" placeholder="최소 50자 이상 입력해주세요" oninput="updateCharCount(this, '취업준비')"></textarea>
                                    <p class="text-xs text-gray-500 mt-1"><span id="취업준비-count">0</span>/50자 이상</p>
                                </div>
                            </div>

                            <!-- 면접준비 -->
                            <div class="space-y-3 p-4 border rounded-lg">
                                <div>
                                    <h4 class="font-medium">7. 면접준비</h4>
                                    <p class="text-sm text-gray-600">면접 과정, 질문, 분위기 등</p>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">난이도 평가 *</label>
                                    <select name="면접준비-rating" required class="w-full p-2 border rounded-md">
                                        <option value="">선택해주세요</option>
                                        <option value="1">1 (쉬움)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4 (어려움)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">상세 리뷰 *</label>
                                    <p class="text-xs text-gray-500 mb-2">면접 과정은 어떻게 진행되는지, 어떤 질문들이 나오는지, 면접 분위기는 어떤지 등을 평가해 주세요.</p>
                                    <textarea name="면접준비-detail" required rows="4" class="w-full p-2 border rounded-md resize-none" placeholder="최소 50자 이상 입력해주세요" oninput="updateCharCount(this, '면접준비')"></textarea>
                                    <p class="text-xs text-gray-500 mt-1"><span id="면접준비-count">0</span>/50자 이상</p>
                                </div>
                            </div>

                            <!-- 한마디 -->
                            <div class="space-y-3 p-4 border rounded-lg">
                                <div>
                                    <h4 class="font-medium">8. 이 곳에서 일하게 될 사람들에게 한마디</h4>
                                </div>
                                <div>
                                    <label class="block text-sm mb-2">상세 리뷰 *</label>
                                    <p class="text-xs text-gray-500 mb-2">앞으로 이 회사에서 일하게 될 사람들에게 조언이나 당부하고 싶은 말씀을 자유롭게 작성해 주세요.</p>
                                    <textarea name="한마디-detail" required rows="4" class="w-full p-2 border rounded-md resize-none" placeholder="최소 50자 이상 입력해주세요" oninput="updateCharCount(this, '한마디')"></textarea>
                                    <p class="text-xs text-gray-500 mt-1"><span id="한마디-count">0</span>/50자 이상</p>
                                </div>
                            </div>

                            <div class="flex gap-4">
                                <button type="button" onclick="prevPage()" class="flex-1 bg-gray-100 py-3 rounded-lg">이전</button>
                                <button type="submit" class="flex-1 bg-blue-600 text-white py-3 rounded-lg">제출하기</button>
                            </div>
                        </div>
                    </div>

                    <div id="errorMessages" class="hidden mt-4 p-4 bg-red-50 border border-red-200 rounded-lg">
                        <div class="flex items-center gap-2 text-red-800">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                            </svg>
                            <ul id="errorList" class="list-disc list-inside space-y-1"></ul>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
    let currentPage = 1;
    const totalPages = 3;

    const minorCategories = {
        "10001": [
            {id: "1000001", name: "호텔·여행·항공"},
            {id: "1000002", name: "스포츠·여가·레저"},
            {id: "1000003", name: "음식료·외식·프랜차이즈"},
            {id: "1000004", name: "뷰티·미용"}
        ],
        "10002": [
            {id: "1000011", name: "은행·금융"},
            {id: "1000012", name: "캐피탈·대출"},
            {id: "1000013", name: "증권·보험·카드"}
        ],
        "10007": [
            {id: "1000038", name: "솔루션·SI·CRM·ERP"},
            {id: "1000039", name: "웹에이전시"},
            {id: "1000040", name: "쇼핑몰·오픈마켓·소셜커머스"}
        ],
        "10031": [
            {id: "1000229", name: "백엔드개발자"},
            {id: "1000230", name: "프론트엔드개발자"},
            {id: "1000231", name: "웹개발자"},
            {id: "1000232", name: "앱개발자"}
        ]
    };

    // 페이지 로드 시 저장된 데이터 복원
    window.addEventListener('load', function() {
        restoreFormData();
    });

    // 폼 데이터 저장
    function saveFormData() {
        const form = document.querySelector('form');
        const formData = new FormData(form);
        const data = {};
        
        // 모든 input, select, textarea 값 저장
        const inputs = form.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            if (input.type === 'checkbox') {
                data[input.name] = input.checked;
            } else if (input.type === 'file') {
                // 파일은 localStorage에 저장할 수 없으므로 스킵
                return;
            } else {
                data[input.name] = input.value;
            }
        });
        
        localStorage.setItem('workReviewFormData', JSON.stringify(data));
    }

    // 폼 데이터 복원
    function restoreFormData() {
        const savedData = localStorage.getItem('workReviewFormData');
        if (!savedData) return;
        
        try {
            const data = JSON.parse(savedData);
            const form = document.querySelector('form');
            
            Object.keys(data).forEach(name => {
                const input = form.querySelector(`[name="${name}"]`);
                if (!input) return;
                
                if (input.type === 'checkbox') {
                    input.checked = data[name];
                } else if (input.type !== 'file') {
                    input.value = data[name];
                }
            });
            
            // 대분류 선택 시 소분류 업데이트
            if (data.majorCategory) {
                updateMinorCategories();
            }
            
            // 현재 재직중 체크박스 상태에 따라 종료일 섹션 표시/숨김
            toggleEndDate();
            
            // 글자 수 카운터 업데이트
            const textareas = form.querySelectorAll('textarea');
            textareas.forEach(textarea => {
                const fieldName = textarea.name.replace('-detail', '');
                updateCharCount(textarea, fieldName);
            });
            
        } catch (e) {
            console.error('저장된 데이터 복원 실패:', e);
        }
    }

    function updateMinorCategories() {
        const majorSelect = document.querySelector('select[name="majorCategory"]');
        const minorSelect = document.getElementById('minorCategory');
        const selectedMajor = majorSelect.value;

        minorSelect.innerHTML = '<option value="">소분류를 선택해주세요</option>';

        if (selectedMajor && minorCategories[selectedMajor]) {
            minorCategories[selectedMajor].forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                minorSelect.appendChild(option);
            });
        }
    }

    function toggleEndDate() {
        const checkbox = document.getElementById('currentJob');
        const endDateSection = document.getElementById('endDateSection');
        
        if (checkbox.checked) {
            endDateSection.classList.add('hidden');
        } else {
            endDateSection.classList.remove('hidden');
        }
    }

    function execDaumPostcode() {
        new daum.Postcode({
            oncomplete: function(data) {
                document.querySelector('input[name="postcode"]').value = data.zonecode;
                document.querySelector('input[name="roadAddress"]').value = data.roadAddress;
                // 주소 입력 후 데이터 저장
                saveFormData();
            }
        }).open();
    }

    function updateCharCount(textarea, fieldName) {
        const count = textarea.value.length;
        document.getElementById(fieldName + '-count').textContent = count;
    }

    function validatePage(page) {
        const errors = [];
        
        if (page === 1) {
            const requiredFields = ['name', 'email', 'phone', 'source', 'education', 'company', 'postcode', 'roadAddress', 'detailAddress', 'majorCategory', 'minorCategory', 'workStartYear', 'workStartMonth'];
            
            requiredFields.forEach(field => {
                const input = document.querySelector(`[name="${field}"]`);
                if (!input.value.trim()) {
                    errors.push(`${field} 필드를 입력해주세요.`);
                }
            });

            // 이메일 형식 검증
            const email = document.querySelector('[name="email"]').value;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (email && !emailRegex.test(email)) {
                errors.push('올바른 이메일 형식을 입력해주세요.');
            }

            // 전화번호 형식 검증
            const phone = document.querySelector('[name="phone"]').value;
            const phoneRegex = /^010-\d{4}-\d{4}$/;
            if (phone && !phoneRegex.test(phone)) {
                errors.push('올바른 전화번호 형식을 입력해주세요. (010-0000-0000)');
            }

            // 개인정보 동의 확인
            if (!document.querySelector('[name="privacyConsent"]').checked) {
                errors.push('개인정보 수집 및 활용에 동의해주세요.');
            }
        }

        if (page === 3) {
            const reviewFields = ['근무환경시설', '근무강도스트레스', '급여복지', '안정성전망', '사람들', '취업준비', '면접준비', '한마디'];
            
            reviewFields.forEach(field => {
                if (field !== '한마디') {
                    const rating = document.querySelector(`[name="${field}-rating"]`);
                    if (!rating.value) {
                        errors.push(`${field} 평가를 선택해주세요.`);
                    }
                }
                
                const detail = document.querySelector(`[name="${field}-detail"]`);
                if (!detail.value.trim() || detail.value.length < 50) {
                    errors.push(`${field} 상세 리뷰를 50자 이상 입력해주세요.`);
                }
            });
        }

        return errors;
    }

    function showErrors(errors) {
        const errorDiv = document.getElementById('errorMessages');
        const errorList = document.getElementById('errorList');
        
        if (errors.length > 0) {
            errorList.innerHTML = errors.map(error => `<li>${error}</li>`).join('');
            errorDiv.classList.remove('hidden');
        } else {
            errorDiv.classList.add('hidden');
        }
    }

    function nextPage() {
        // 현재 페이지 데이터 저장
        saveFormData();
        
        const errors = validatePage(currentPage);
        
        if (errors.length > 0) {
            showErrors(errors);
            return;
        }

        showErrors([]);

        if (currentPage < totalPages) {
            document.getElementById(`page${currentPage}`).classList.add('hidden');
            currentPage++;
            document.getElementById(`page${currentPage}`).classList.remove('hidden');
            updateProgress();
            window.scrollTo(0, 0);
        }
    }

    function prevPage() {
        // 현재 페이지 데이터 저장
        saveFormData();
        
        if (currentPage > 1) {
            document.getElementById(`page${currentPage}`).classList.add('hidden');
            currentPage--;
            document.getElementById(`page${currentPage}`).classList.remove('hidden');
            updateProgress();
            window.scrollTo(0, 0);
        }
    }

    function updateProgress() {
        const progress = (currentPage / totalPages) * 100;
        document.getElementById('progressBar').style.width = progress + '%';
        document.getElementById('currentStep').textContent = currentPage;
    }

    // 입력 필드 변경 시 자동 저장
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form');
        
        // 모든 input, select, textarea에 이벤트 리스너 추가
        form.addEventListener('input', saveFormData);
        form.addEventListener('change', saveFormData);
        
        // 폼 제출 시 최종 검증
        form.addEventListener('submit', function(e) {
            const errors = validatePage(3);
            if (errors.length > 0) {
                e.preventDefault();
                showErrors(errors);
                return false;
            }
            
            // 제출 성공 시 저장된 데이터 삭제
            localStorage.removeItem('workReviewFormData');
        });
    });
</script>
</body>
</html>
